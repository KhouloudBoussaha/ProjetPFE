{"ast":null,"code":"import { IncidentType } from '../incident-type';\nimport { Impact } from '../impact';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../alerte.service\";\nimport * as i2 from \"../auth.service\";\nimport * as i3 from \"@angular/common\";\nfunction AdminIncidentListComponent_div_4_button_14_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 14);\n    i0.ɵɵlistener(\"click\", function AdminIncidentListComponent_div_4_button_14_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const alerte_r1 = i0.ɵɵnextContext().$implicit;\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.markAsResolved(alerte_r1));\n    });\n    i0.ɵɵtext(1, \" Marquer comme r\\u00E9solu \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction AdminIncidentListComponent_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 4)(1, \"div\", 5)(2, \"div\", 6)(3, \"span\", 7);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"span\", 8);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(7, \"p\", 9);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"div\", 10)(10, \"small\", 11);\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(12, \"span\", 12);\n    i0.ɵɵtext(13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(14, AdminIncidentListComponent_div_4_button_14_Template, 2, 0, \"button\", 13);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const alerte_r1 = ctx.$implicit;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(alerte_r1.type);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngClass\", ctx_r0.getImpactBadgeClass(alerte_r1.impact));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", alerte_r1.impact, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(alerte_r1.description);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"\\uD83D\\uDC64 \", (alerte_r1.createdBy == null ? null : alerte_r1.createdBy.username) || \"Utilisateur inconnu\", \"\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngClass\", ctx_r0.getResolvedBadgeClass(alerte_r1.resolved));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", alerte_r1.resolved ? \"R\\u00E9solu\" : \"Non r\\u00E9solu\", \" \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !alerte_r1.resolved);\n  }\n}\nexport class AdminIncidentListComponent {\n  constructor(alerteService, authService) {\n    this.alerteService = alerteService;\n    this.authService = authService;\n    this.alertes = [];\n    this.incidentTypes = Object.keys(IncidentType).filter(key => isNaN(+key));\n    this.impact = Object.keys(Impact).filter(key => isNaN(+key));\n  }\n  ngOnInit() {\n    this.loadAlertes();\n  }\n  loadAlertes() {\n    this.alerteService.getAllAlertes().subscribe({\n      next: data => {\n        console.log('Alertes chargées:', data);\n        this.alertes = data;\n      },\n      error: error => {\n        console.error('Erreur chargement alertes:', error);\n      }\n    });\n  }\n  markAsResolved(alerte) {\n    if (!alerte.id) return;\n    this.alerteService.resolveAlerte(alerte.id).subscribe({\n      next: updatedAlerte => {\n        // Mise à jour locale de l'alerte dans la liste\n        const index = this.alertes.findIndex(a => a.id === updatedAlerte.id);\n        if (index !== -1) {\n          this.alertes[index] = updatedAlerte;\n        }\n      },\n      error: err => console.error('Erreur lors du marquage comme résolu', err)\n    });\n  }\n  getResolvedBadgeClass(resolved) {\n    return resolved ? 'badge bg-success' : 'badge bg-danger';\n  }\n  getImpactBadgeClass(impact) {\n    switch (impact) {\n      case 'HIGH':\n        return 'bg-danger';\n      // Rouge pour impact élevé\n      case 'MEDIUM':\n        return 'bg-warning';\n      // Jaune pour impact moyen\n      case 'LOW':\n        return 'bg-success';\n      // Vert pour impact faible\n      default:\n        return 'bg-secondary';\n      // Gris par défaut\n    }\n  }\n\n  static {\n    this.ɵfac = function AdminIncidentListComponent_Factory(t) {\n      return new (t || AdminIncidentListComponent)(i0.ɵɵdirectiveInject(i1.AlerteService), i0.ɵɵdirectiveInject(i2.AuthService));\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: AdminIncidentListComponent,\n      selectors: [[\"app-admin-incident-list\"]],\n      decls: 5,\n      vars: 1,\n      consts: [[1, \"container\", \"mt-5\"], [1, \"mb-4\", \"text-primary\"], [1, \"row\", \"g-4\"], [\"class\", \"col-md-6 col-lg-4\", 4, \"ngFor\", \"ngForOf\"], [1, \"col-md-6\", \"col-lg-4\"], [1, \"alert-card\", \"shadow-sm\", \"p-4\", \"rounded-3\", \"bg-white\"], [1, \"d-flex\", \"justify-content-between\", \"align-items-center\", \"mb-2\"], [1, \"fw-bold\", \"text-dark\"], [1, \"badge\", \"rounded-pill\", 3, \"ngClass\"], [1, \"text-muted\", \"fst-italic\"], [1, \"text-end\", \"mt-3\"], [1, \"text-secondary\"], [3, \"ngClass\"], [\"class\", \"btn btn-sm btn-primary ms-2\", 3, \"click\", 4, \"ngIf\"], [1, \"btn\", \"btn-sm\", \"btn-primary\", \"ms-2\", 3, \"click\"]],\n      template: function AdminIncidentListComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"h2\", 1);\n          i0.ɵɵtext(2, \"\\uD83C\\uDF89 Incidents d\\u00E9clar\\u00E9s\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(3, \"div\", 2);\n          i0.ɵɵtemplate(4, AdminIncidentListComponent_div_4_Template, 15, 8, \"div\", 3);\n          i0.ɵɵelementEnd()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(4);\n          i0.ɵɵproperty(\"ngForOf\", ctx.alertes);\n        }\n      },\n      dependencies: [i3.NgClass, i3.NgForOf, i3.NgIf],\n      styles: [\".main-content[_ngcontent-%COMP%] {\\n  \\n\\n  margin-left: 0;\\n}\\n.alert-title[_ngcontent-%COMP%] {\\n  color: red;\\n  font-size: 2rem;       \\n\\n  font-weight: bold;\\n  text-align: center;\\n  margin-bottom: 0.5rem; \\n\\n}\\n\\n.alert-description[_ngcontent-%COMP%] {\\n  text-align: center;\\n  font-size: 1rem;\\n  color: #555;          \\n\\n  margin-top: 0;\\n  font-style: italic;\\n  margin-bottom: 10rem;\\n}\\n\\n.content-inner[_ngcontent-%COMP%] {\\n  max-width: 100%;\\n  overflow: visible;\\n  height: auto;\\n}\\n.table-container[_ngcontent-%COMP%] {\\n background-color: rgba(255, 255, 255, 0.9);\\n  padding: 0.5rem;\\n  border-radius: 12px;\\n  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);\\n \\n   \\n\\n \\n\\n \\n   \\n\\n \\n  \\n\\n  color: black !important;\\n}\\n.alert-card[_ngcontent-%COMP%] {\\n  background: #fefefe;\\n  border-left: 6px solid #0d6efd;\\n  border-radius: 12px;\\n  transition: all 0.3s ease-in-out;\\n}\\n\\n.alert-card[_ngcontent-%COMP%]:hover {\\n  transform: translateY(-5px);\\n  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.08);\\n}\\n\\n.badge[_ngcontent-%COMP%] {\\n  font-size: 0.75rem;\\n  padding: 6px 12px;\\n}\\n\\n.badge.HIGH[_ngcontent-%COMP%] {\\n  background-color: #dc3545;\\n  color: white;\\n}\\n\\n.badge.MEDIUM[_ngcontent-%COMP%] {\\n  background-color: #ffc107;\\n  color: black;\\n}\\n\\n.badge.LOW[_ngcontent-%COMP%] {\\n  background-color: #28a745;\\n  color: white;\\n}\"]\n    });\n  }\n}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}